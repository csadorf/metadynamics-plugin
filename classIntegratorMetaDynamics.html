<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>metadynamics: IntegratorMetaDynamics Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">metadynamics
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<div class="title">IntegratorMetaDynamics Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Implements a metadynamics update scheme. </p>
<p>This class implements an integration scheme for metadynamics.</p>
<p>For a review of metadynamics, a free-energy measurement technique, see Barducci et al., Metadynamics, Wiley Interdiscipl. Rev.: Comput. Mol. Sci. 5, pp. 826-843 (2011).</p>
<p>Some of the features of this class are loosely inspired by the PLUMED plugin for Metadynamics, <a href="http://www.plumed-code.org/">http://www.plumed-code.org/</a>.</p>
<p>The <a class="el" href="classIntegratorMetaDynamics.html" title="Implements a metadynamics update scheme.">IntegratorMetaDynamics</a> class takes a number of CollectiveVariables, and uses their values during the course of the simulation to update the bias potential, a sum of Gaussians, which disfavors revisiting visited states. The derivative of the bias potential (with respect to the collective coordinate) in turn multiplies the force on the particles as defined by the collective variable.</p>
<p>The bias potential is updated every stride steps.</p>
<p>Well-tempered metadynamics is supported by default, a value of T_shift defines the temperature shift entering the scaling factor for the bias potential (see above ref. for details). Very large values of T_shift correspond to standard metadynamics, T_shift-&gt;0 corresponds to standard molecular dynamics.</p>
<p>Two modes of operation are supported: in the first mode, the Gaussians are resummed every time step. With increasing simulation time, this process will take longer, and slow down the simulation. In the second mode, a grid mode, a current grid of values of the collective variables is maintained and updated whenever a new Gaussian is deposited. The value of the bias potential and its derivatives of the potential are calculated by using numerical interpolation. In this mode, the time per step is O(1), so this mode is preferrable for long simulations.</p>
<p>It is possible to output the grid after the simulation, and to restart from the grid file. It is also possible to restart from the grid file and turn off the deposition of new Gaussians, e.g. to equilibrate the system in the bias potential landscape and measure the histogram of the collective variable, to correct for errors. </p>
</div>
<p><a href="classIntegratorMetaDynamics-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afd6e11107780a287dd71ce66a2fa620c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#afd6e11107780a287dd71ce66a2fa620c">IntegratorMetaDynamics</a> (boost::shared_ptr&lt; SystemDefinition &gt; sysdef, Scalar deltaT, Scalar W, Scalar T_shift, unsigned int stride, bool add_hills=true, const std::string &amp;filename=&quot;&quot;, bool overwrite=false, bool use_grid=false)</td></tr>
<tr class="memitem:acb5c845e7464daa43f2a4fa3bb36d894"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#acb5c845e7464daa43f2a4fa3bb36d894">update</a> (unsigned int timestep)</td></tr>
<tr class="memitem:a3ad6733f4ce3eaf65a45f126c9f0e958"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#a3ad6733f4ce3eaf65a45f126c9f0e958">prepRun</a> (unsigned int timestep)</td></tr>
<tr class="memitem:af09ca303af79694e4ce84b3aa1ea56e5"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#af09ca303af79694e4ce84b3aa1ea56e5">printStats</a> ()</td></tr>
<tr class="memitem:a8767658cbd295b709bfb3edbf46f0f96"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#a8767658cbd295b709bfb3edbf46f0f96">registerCollectiveVariable</a> (boost::shared_ptr&lt; <a class="el" href="classCollectiveVariable.html">CollectiveVariable</a> &gt; cv, Scalar sigma, Scalar cv_min=Scalar(0.0), Scalar cv_max=Scalar(0.0), int num_points=0)</td></tr>
<tr class="memitem:ab0a431ccb309464884ce76cd86fbe3e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#ab0a431ccb309464884ce76cd86fbe3e5">removeAllVariables</a> ()</td></tr>
<tr class="memitem:a5d94f49511afdbcbac19abd5f4c0496c"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#a5d94f49511afdbcbac19abd5f4c0496c">getProvidedLogQuantities</a> ()</td></tr>
<tr class="memitem:a19d3baceb30c0e6973480640ea41cbf7"><td class="memItemLeft" align="right" valign="top">Scalar&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#a19d3baceb30c0e6973480640ea41cbf7">getLogValue</a> (const std::string &amp;quantity, unsigned int timestep)</td></tr>
<tr class="memitem:ad622a68104b0fc4e37fd0f1551ccdfdb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#ad622a68104b0fc4e37fd0f1551ccdfdb">setGrid</a> (bool use_grid)</td></tr>
<tr class="memitem:a04321e4762171080622518d52bc4624a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#a04321e4762171080622518d52bc4624a">isInitialized</a> ()</td></tr>
<tr class="memitem:a23f42bfd49ed0d0ddd38ff28a95db920"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#a23f42bfd49ed0d0ddd38ff28a95db920">dumpGrid</a> (const std::string &amp;filename)</td></tr>
<tr class="memitem:a67062656a11f78558dbb9f593563bd6f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#a67062656a11f78558dbb9f593563bd6f">restartFromGridFile</a> (const std::string &amp;filename)</td></tr>
<tr class="memitem:acb9562e2881ceb3ee738bfba8ee056e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#acb9562e2881ceb3ee738bfba8ee056e5">setAddHills</a> (bool add_hills)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:adcc232322735189db4266bf8e7e11871"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adcc232322735189db4266bf8e7e11871"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#adcc232322735189db4266bf8e7e11871">updateBiasPotential</a> (unsigned int timestep)</td></tr>
<tr class="memdesc:adcc232322735189db4266bf8e7e11871"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal helper function to update the bias potential. <br/></td></tr>
<tr class="memitem:ad10bceee6e90b5c6c2b37ca2ecc3a9eb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad10bceee6e90b5c6c2b37ca2ecc3a9eb"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#ad10bceee6e90b5c6c2b37ca2ecc3a9eb">openOutputFile</a> ()</td></tr>
<tr class="memdesc:ad10bceee6e90b5c6c2b37ca2ecc3a9eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to open output file for logging. <br/></td></tr>
<tr class="memitem:af229239804616552c177bcf32e509f46"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af229239804616552c177bcf32e509f46"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#af229239804616552c177bcf32e509f46">writeFileHeader</a> ()</td></tr>
<tr class="memdesc:af229239804616552c177bcf32e509f46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to write file header. <br/></td></tr>
<tr class="memitem:a361f8b0228dc5c1b123c67fe87702abc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a361f8b0228dc5c1b123c67fe87702abc"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#a361f8b0228dc5c1b123c67fe87702abc">setupGrid</a> ()</td></tr>
<tr class="memdesc:a361f8b0228dc5c1b123c67fe87702abc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to initialize the grid. <br/></td></tr>
<tr class="memitem:aa6184173cc9482594270cee66972100e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa6184173cc9482594270cee66972100e"></a>
Scalar&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#aa6184173cc9482594270cee66972100e">interpolateBiasPotential</a> (const std::vector&lt; Scalar &gt; &amp;val)</td></tr>
<tr class="memdesc:aa6184173cc9482594270cee66972100e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to get value of bias potential by multilinear interpolation. <br/></td></tr>
<tr class="memitem:a344862e0eb248c49ca89d7666116ec8f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a344862e0eb248c49ca89d7666116ec8f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#a344862e0eb248c49ca89d7666116ec8f">readGrid</a> (const std::string &amp;filename)</td></tr>
<tr class="memdesc:a344862e0eb248c49ca89d7666116ec8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to read in data from grid file. <br/></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ac5a64138ca6a801d4d08bd9f7c80bff8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac5a64138ca6a801d4d08bd9f7c80bff8"></a>
Scalar&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#ac5a64138ca6a801d4d08bd9f7c80bff8">m_W</a></td></tr>
<tr class="memdesc:ac5a64138ca6a801d4d08bd9f7c80bff8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Height of Gaussians. <br/></td></tr>
<tr class="memitem:a907323f86cf81a19d94d40f1793836f0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a907323f86cf81a19d94d40f1793836f0"></a>
Scalar&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#a907323f86cf81a19d94d40f1793836f0">m_T_shift</a></td></tr>
<tr class="memdesc:a907323f86cf81a19d94d40f1793836f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Temperature shift. <br/></td></tr>
<tr class="memitem:ae3efb7f7caab30ef8113007525f5c1e2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae3efb7f7caab30ef8113007525f5c1e2"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#ae3efb7f7caab30ef8113007525f5c1e2">m_stride</a></td></tr>
<tr class="memdesc:ae3efb7f7caab30ef8113007525f5c1e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of timesteps between Gaussian depositions. <br/></td></tr>
<tr class="memitem:aaf7380c6585292abe1a1ce18c7437944"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aaf7380c6585292abe1a1ce18c7437944"></a>
std::vector<br class="typebreak"/>
&lt; <a class="el" href="structCollectiveVariableItem.html">CollectiveVariableItem</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#aaf7380c6585292abe1a1ce18c7437944">m_variables</a></td></tr>
<tr class="memdesc:aaf7380c6585292abe1a1ce18c7437944"><td class="mdescLeft">&#160;</td><td class="mdescRight">The list of collective variables. <br/></td></tr>
<tr class="memitem:aa66ee97b7d80ee2b2ac5067da6d7243a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa66ee97b7d80ee2b2ac5067da6d7243a"></a>
std::vector&lt; std::vector<br class="typebreak"/>
&lt; Scalar &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#aa66ee97b7d80ee2b2ac5067da6d7243a">m_cv_values</a></td></tr>
<tr class="memdesc:aa66ee97b7d80ee2b2ac5067da6d7243a"><td class="mdescLeft">&#160;</td><td class="mdescRight">History of CV values. <br/></td></tr>
<tr class="memitem:aee26657188e71e342f257b95f55388c7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aee26657188e71e342f257b95f55388c7"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#aee26657188e71e342f257b95f55388c7">m_num_update_steps</a></td></tr>
<tr class="memdesc:aee26657188e71e342f257b95f55388c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of update steps performed in this run thus far. <br/></td></tr>
<tr class="memitem:a83e5004c18a1a6d37db24dcd14fc1053"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a83e5004c18a1a6d37db24dcd14fc1053"></a>
std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#a83e5004c18a1a6d37db24dcd14fc1053">m_log_names</a></td></tr>
<tr class="memdesc:a83e5004c18a1a6d37db24dcd14fc1053"><td class="mdescLeft">&#160;</td><td class="mdescRight">Names of logging quantities. <br/></td></tr>
<tr class="memitem:a7552247dcef6ed5747fbbcef0695ce8b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7552247dcef6ed5747fbbcef0695ce8b"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#a7552247dcef6ed5747fbbcef0695ce8b">m_suffix</a></td></tr>
<tr class="memdesc:a7552247dcef6ed5747fbbcef0695ce8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Suffix for unbiased variables. <br/></td></tr>
<tr class="memitem:aee62c36852542da986020d6d6ebc98c0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aee62c36852542da986020d6d6ebc98c0"></a>
Scalar&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#aee62c36852542da986020d6d6ebc98c0">m_curr_bias_potential</a></td></tr>
<tr class="memdesc:aee62c36852542da986020d6d6ebc98c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">The sum of Gaussians. <br/></td></tr>
<tr class="memitem:ad4471f80bb8287d4c71ad89c3ee04e57"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad4471f80bb8287d4c71ad89c3ee04e57"></a>
std::vector&lt; Scalar &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#ad4471f80bb8287d4c71ad89c3ee04e57">m_bias_potential</a></td></tr>
<tr class="memdesc:ad4471f80bb8287d4c71ad89c3ee04e57"><td class="mdescLeft">&#160;</td><td class="mdescRight">List of values of the bias potential. <br/></td></tr>
<tr class="memitem:a847674b4523529e82e0c61029a07f512"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a847674b4523529e82e0c61029a07f512"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#a847674b4523529e82e0c61029a07f512">m_is_initialized</a></td></tr>
<tr class="memdesc:a847674b4523529e82e0c61029a07f512"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if history-dependent potential has been initialized. <br/></td></tr>
<tr class="memitem:a294fc0ffd4511d48fad3989ee33219eb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a294fc0ffd4511d48fad3989ee33219eb"></a>
const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#a294fc0ffd4511d48fad3989ee33219eb">m_filename</a></td></tr>
<tr class="memdesc:a294fc0ffd4511d48fad3989ee33219eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name of output file. <br/></td></tr>
<tr class="memitem:a9bc6e11e0405a6c6e72de8c3737e2a3a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9bc6e11e0405a6c6e72de8c3737e2a3a"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#a9bc6e11e0405a6c6e72de8c3737e2a3a">m_overwrite</a></td></tr>
<tr class="memdesc:a9bc6e11e0405a6c6e72de8c3737e2a3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if the file should be overwritten. <br/></td></tr>
<tr class="memitem:a0d18cf359b14c7ea7fca4b2aeac23474"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0d18cf359b14c7ea7fca4b2aeac23474"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#a0d18cf359b14c7ea7fca4b2aeac23474">m_is_appending</a></td></tr>
<tr class="memdesc:a0d18cf359b14c7ea7fca4b2aeac23474"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if we are appending to the file. <br/></td></tr>
<tr class="memitem:a8ee3570261d450446220dbac1c5eedd3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8ee3570261d450446220dbac1c5eedd3"></a>
std::ofstream&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#a8ee3570261d450446220dbac1c5eedd3">m_file</a></td></tr>
<tr class="memdesc:a8ee3570261d450446220dbac1c5eedd3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output log file. <br/></td></tr>
<tr class="memitem:ad38744d631ffe847abb972199225c2ff"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad38744d631ffe847abb972199225c2ff"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#ad38744d631ffe847abb972199225c2ff">m_delimiter</a></td></tr>
<tr class="memdesc:ad38744d631ffe847abb972199225c2ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delimiting string. <br/></td></tr>
<tr class="memitem:a220d1597eafa76953e43da26078d5674"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a220d1597eafa76953e43da26078d5674"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#a220d1597eafa76953e43da26078d5674">m_use_grid</a></td></tr>
<tr class="memdesc:a220d1597eafa76953e43da26078d5674"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if we are using a grid. <br/></td></tr>
<tr class="memitem:a3d3e5c531827b89d3bf5d964ced1799e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3d3e5c531827b89d3bf5d964ced1799e"></a>
std::vector&lt; Scalar &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#a3d3e5c531827b89d3bf5d964ced1799e">m_grid</a></td></tr>
<tr class="memdesc:a3d3e5c531827b89d3bf5d964ced1799e"><td class="mdescLeft">&#160;</td><td class="mdescRight">d-dimensional grid to store values of bias potential <br/></td></tr>
<tr class="memitem:a23fe1db58d00a5db152bee4d79f5a86c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a23fe1db58d00a5db152bee4d79f5a86c"></a>
<a class="el" href="classIndexGrid.html">IndexGrid</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#a23fe1db58d00a5db152bee4d79f5a86c">m_grid_index</a></td></tr>
<tr class="memdesc:a23fe1db58d00a5db152bee4d79f5a86c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indexer for the d-dimensional grid. <br/></td></tr>
<tr class="memitem:a194c5d4aa72cebb24f36a2484eebc5ae"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a194c5d4aa72cebb24f36a2484eebc5ae"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#a194c5d4aa72cebb24f36a2484eebc5ae">m_add_hills</a></td></tr>
<tr class="memdesc:a194c5d4aa72cebb24f36a2484eebc5ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if hills should be added during the simulation. <br/></td></tr>
<tr class="memitem:afb750cfc4139b288705b20d03a9e60fd"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afb750cfc4139b288705b20d03a9e60fd"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIntegratorMetaDynamics.html#afb750cfc4139b288705b20d03a9e60fd">m_restart_filename</a></td></tr>
<tr class="memdesc:afb750cfc4139b288705b20d03a9e60fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name of file to read restart information from. <br/></td></tr>
</table>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="afd6e11107780a287dd71ce66a2fa620c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntegratorMetaDynamics.html">IntegratorMetaDynamics</a> </td>
          <td>(</td>
          <td class="paramtype">boost::shared_ptr&lt; SystemDefinition &gt;&#160;</td>
          <td class="paramname"><em>sysdef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Scalar&#160;</td>
          <td class="paramname"><em>deltaT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Scalar&#160;</td>
          <td class="paramname"><em>W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Scalar&#160;</td>
          <td class="paramname"><em>T_shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>stride</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>add_hills</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em> = <code>&quot;&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>overwrite</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>use_grid</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor </p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">sysdef</td><td>System definition </td></tr>
    <tr><td class="paramname">deltaT</td><td>Time step </td></tr>
    <tr><td class="paramname">W</td><td>Weight of Gaussians (multiplicative factor) </td></tr>
    <tr><td class="paramname">T_shift</td><td>Temperature shift for well-tempered metadynamics </td></tr>
    <tr><td class="paramname">stride</td><td>Number of time steps between deposition of Gaussians </td></tr>
    <tr><td class="paramname">add_hills</td><td>True if new Gaussians should be added during the simulation </td></tr>
    <tr><td class="paramname">filename</td><td>Name of file to output hill information to </td></tr>
    <tr><td class="paramname">overwrite</td><td>True f the file should be overwritten when it exists already </td></tr>
    <tr><td class="paramname">use_grid</td><td>True if grid should be used </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a23f42bfd49ed0d0ddd38ff28a95db920"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dumpGrid </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Output the grid to a file </p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>Name of file to dump grid to </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a19d3baceb30c0e6973480640ea41cbf7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Scalar getLogValue </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>quantity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>timestep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Obtain the value of a specific log quantity </p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">quantity</td><td>The quantity to obtain the value of </td></tr>
    <tr><td class="paramname">timestep</td><td>The current value of the time step </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a5d94f49511afdbcbac19abd5f4c0496c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::string &gt; getProvidedLogQuantities </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the names of log quantitites provided by this integrator </p>

</div>
</div>
<a class="anchor" id="a04321e4762171080622518d52bc4624a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool isInitialized </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns true if the integration has been initialized (i.e. the simulation has been run at least once) </p>

</div>
</div>
<a class="anchor" id="a3ad6733f4ce3eaf65a45f126c9f0e958"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void prepRun </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>timestep</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Prepare for the run </p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">timestep</td><td>The current value of the timestep </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af09ca303af79694e4ce84b3aa1ea56e5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void printStats </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Output statistics at end of run (unimplemented as of now) </p>

</div>
</div>
<a class="anchor" id="a8767658cbd295b709bfb3edbf46f0f96"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void registerCollectiveVariable </td>
          <td>(</td>
          <td class="paramtype">boost::shared_ptr&lt; <a class="el" href="classCollectiveVariable.html">CollectiveVariable</a> &gt;&#160;</td>
          <td class="paramname"><em>cv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Scalar&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Scalar&#160;</td>
          <td class="paramname"><em>cv_min</em> = <code>Scalar(0.0)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Scalar&#160;</td>
          <td class="paramname"><em>cv_max</em> = <code>Scalar(0.0)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_points</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Register a new collective variable </p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">cv</td><td>The collective variable </td></tr>
    <tr><td class="paramname">sigma</td><td>The standard deviation of Gaussians for this collective variable </td></tr>
    <tr><td class="paramname">cv_min</td><td>Minimum value, if using grid </td></tr>
    <tr><td class="paramname">cv_max</td><td>Maximum value, if using grid </td></tr>
    <tr><td class="paramname">num_points</td><td>Number of grid points to use for interpolation </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab0a431ccb309464884ce76cd86fbe3e5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void removeAllVariables </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Remove all collective variables </p>

</div>
</div>
<a class="anchor" id="a67062656a11f78558dbb9f593563bd6f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void restartFromGridFile </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Restart from a grid file. Upon running the simulation, the information will be read in.</p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>The name of the file that contains the grid information </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="acb9562e2881ceb3ee738bfba8ee056e5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void setAddHills </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>add_hills</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set a flag that controls deposition of new Gaussian hills </p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">add_hills</td><td>True if hills should be generated during the simulation </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad622a68104b0fc4e37fd0f1551ccdfdb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setGrid </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>use_grid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set up grid interpolation </p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">use_grid</td><td>True if the grid is to be used </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="acb5c845e7464daa43f2a4fa3bb36d894"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void update </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>timestep</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Sample collective variables, update bias potential and derivatives </p>
<dl class="params"><dt>Parameters:</dt><dd>
  <table class="params">
    <tr><td class="paramname">timestep</td><td>The current value of the timestep </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="IntegratorMetaDynamics_8h.html">IntegratorMetaDynamics.h</a></li>
<li><a class="el" href="IntegratorMetaDynamics_8cc.html">IntegratorMetaDynamics.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jun 27 2012 14:48:32 for metadynamics by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.1
</small></address>
</body>
</html>
